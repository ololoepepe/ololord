<% c++ #include "controller/base.h" %>
<% skin my_skin %>
<% view base uses Content::Base %>

<% template settings() %>
<div class="settingsBar">
    <span>
        <%= localeLabelText %>
        <select id="localeChangeSelect" class="select" onchange="javascript:changeLocale();">
            <% foreach locale in locales %>
                <% item %>
                    <% if ( locale.name == content.currentLocale.name ) %>
                        <option value="<%= locale.name %>" selected="true">
                    <% else %>
                        <option value="<%= locale.name %>">
                    <% end %>
                        <%= locale.language %> (<%= locale.country %>)
                    </option>
                <% end %>
            <% end %>
        </select>
    </span>
    <span>
        <%= styleLabelText %>
        <select id="styleChangeSelect" class="select" onchange="javascript:changeStyle();">
            <% foreach st in styles %>
                <% item %>
                    <% if ( st.name == content.style.name ) %>
                        <option value="<%= st.name %>" selected="true">
                    <% else %>
                        <option value="<%= st.name %>">
                    <% end %>
                        <%= st.title %>
                    </option>
                <% end %>
            <% end %>
        </select>
    </span>
    <span>
        <%= timeLabelText %>
        <select id="timeChangeSelect" class="select" onchange="javascript:changeTime();">
            <% if ( content.currentTime == "local" ) %>
                <option value="server"><%= timeServerText %></option>
                <option value="local" selected="true"><%= timeLocalText %></option>
            <% else %>
                <option value="server" selected="true"><%= timeServerText %></option>
                <option value="local"><%= timeLocalText %></option>
            <% end %>
        </select>
    </span>
    <span>
        <%= loginLabelText %>
        <% if ( content.loggedIn ) %>
            <button class="button" onclick="javascript:lord.doLogout();"><%= loginButtonText %></button>
            <input id="showTripcodeCheckbox" type="checkbox" class="checkbox" title="<%= showTripcodeText %>"
                   onclick="javascript:switchShowTripcode();" name="showTripcode" />
        <% else %>
            <input id="loginInput" type="password" class="input" name="hashpass"
                   placeholder="<%= loginPlaceholderText %>" />
            <input id="showLoginCheckbox" type="checkbox" class="checkbox" onclick="javascript:switchShowLogin();"
                   name="showLogin" title="<%= showPasswordText %>" />
            <button class="button" onclick="javascript:doLogin();"><%= loginButtonText %></button>
        <% end %>
        <% if ( !content.loginMessageWarning.empty() ) %>
            <span class="loginMessageWarning"><%= loginMessageWarning %></span>
        <% elif ( !content.loginMessageOk.empty() ) %>
            <span class="loginMessageOk"><%= loginMessageOk %></span>
        <% end %>
    </span>
</div>
<% end template %>

<% template navbar() %>
<div class="navbar">
    <% foreach board in boards %>
        <% item %>
        <span class="navbarItem">[<a href="/<%= sitePathPrefix %><%= board.name %>"
              title="<%= board.title %>"><%= board.name %></a>] </span>
        <% end %>
    <% empty %>
    <% end %>
    <span class="navbarItem">[<a href="/<%= sitePathPrefix %>"><%= toHomePageText %></a>]</span>
</div>
<% end template %>

<% template searchAction(std::string position) %>
<% if ( !content.searchApiKey.empty() ) %>
    <div class="searchAction">
        <input type="hidden" id="hideSearchFormText" value="<%= hideSearchFormText %>" />
        <input type="hidden" id="showSearchFormText" value="<%= showSearchFormText %>" />
        <div>
            [<a id="showHideSearchFormButton<%= position %>"
                href="javascript:showHideSearchForm('<%= position %>');">
                <%= showSearchFormText %>
            </a>]
        </div>
        <script>
            (function() {
                var gcse = document.createElement("script");
                gcse.type = "text/javascript";
                gcse.async = true;
                gcse.src = (document.location.protocol == "https:" ? "https:" : "http:") +
                    "//www.google.com/cse/cse.js?cx=<%= searchApiKey %>";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(gcse, s);
            })();
        </script>
        <div id="searchForm<%= position %>" class="searchFormInvisible">
            <gcse:search></gcse:search>
        </div>
    </div>
<% end %>
<% end template %>

<% template baseTexts() %>
<input type="hidden" id="sitePathPrefix" value="<%= sitePathPrefix %>" />
<input type="hidden" id="siteDomain" value="<%= siteDomain %>" />
<input type="hidden" id="siteProtocol" value="<%= siteProtocol %>" />
<input type="hidden" id="showPasswordText" value="<%= showPasswordText %>" />
<input type="hidden" id="cancelButtonText" value="<%= cancelButtonText %>" />
<input type="hidden" id="confirmButtonText" value="<%= confirmButtonText %>" />
<% end template %>

<% template baseHead(bool javascript) %>
<title><%= pageTitle %></title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<link id="favicon" rel="shortcut icon" href="/<%= sitePathPrefix %>favicon.ico">
<% if ( javascript ) %>
    <script type="text/javascript" src="/<%= sitePathPrefix %>js/3rdparty/picoModal-2.1.0.min.js"></script>
    <script type="text/javascript" src="/<%= sitePathPrefix %>js/3rdparty/sha1.js"></script>
    <script type="text/javascript" src="/<%= sitePathPrefix %>js/base.js"></script>
<% end %>
<% end template %>

<% end view %>
<% end skin %>
